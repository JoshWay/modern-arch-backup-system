# Sudoers rule for backup operations
# This allows the backup user to run specific backup commands without password
# Copy this to /etc/sudoers.d/backup-operations
# Replace USERNAME with your actual username

# Allow only specific btrbk operations with config file
USERNAME ALL=(root) NOPASSWD: /usr/bin/btrbk -c /etc/btrbk/btrbk.conf run
USERNAME ALL=(root) NOPASSWD: /usr/bin/btrbk -c /etc/btrbk/btrbk.conf list
USERNAME ALL=(root) NOPASSWD: /usr/bin/btrbk -c /etc/btrbk/btrbk.conf stats

# Allow specific backup script execution
USERNAME ALL=(root) NOPASSWD: /usr/local/bin/system-backup.sh

# Allow read-only filesystem operations for recovery
USERNAME ALL=(root) NOPASSWD: /usr/bin/mount -r -o subvol=.snapshots/* /dev/* /mnt/snapshot
USERNAME ALL=(root) NOPASSWD: /usr/bin/umount /mnt/snapshot
